# –†–µ–∑—é–º–µ: –ò–∑—É—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Telegram Mini Apps –∏ —Ä–∞–±–æ—Ç–∞ —Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–µ–π

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –ò–∑—É—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Telegram Mini Apps

–ò–∑—É—á–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ Telegram Mini Apps, –≤–∫–ª—é—á–∞—è:
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é Mini Apps
- –†–∞–±–æ—Ç—É —Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–µ–π (–æ—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ)
- –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
- DeviceStorage –∏ SecureStorage
- –î—Ä—É–≥–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ API

### 2. –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞:
- `/frontend/lib/location.ts` - —Ä–∞–±–æ—Ç–∞ —Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–µ–π
- `/frontend/pages/_app.tsx` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebApp
- `/frontend/store/useStore.ts` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –≤ store
- `/frontend/pages/index.tsx` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ API

#### –û–±–Ω–æ–≤–ª–µ–Ω `/frontend/lib/location.ts`:
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤–æ–≥–æ **LocationManager API** (Bot API 8.0+)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω fallback –Ω–∞ —Å—Ç–∞—Ä—ã–π `requestLocation` API (Bot API 6.0+) –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `checkLocationPermission()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `openLocationSettings()` –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–æ—á–Ω–æ—Å—Ç–∏ (`horizontalAccuracy`)

#### –û–±–Ω–æ–≤–ª–µ–Ω `/frontend/pages/_app.tsx`:
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è LocationManager –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π `locationManagerUpdated` –∏ `locationRequested`

### 4. –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–æ–∑–¥–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:
1. **TELEGRAM_MINI_APPS_DOCUMENTATION.md** - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ Telegram Mini Apps
2. **TELEGRAM_LOCATION_MIGRATION_GUIDE.md** - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –Ω–æ–≤—ã–π API
3. **–û–±–Ω–æ–≤–ª–µ–Ω LOCATION_FEATURE.md** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–æ–≤–æ–º API

## –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –ù–æ–≤—ã–π LocationManager API (Bot API 8.0+)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ—á–Ω–æ—Å—Ç–∏ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è
- –°–æ–±—ã—Ç–∏—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞
- –ú–µ—Ç–æ–¥ `openSettings()` –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```typescript
const locationManager = WebApp.LocationManager;
locationManager.init(() => {
  if (locationManager.isPermissionGranted) {
    locationManager.getLocation((locationData) => {
      console.log(locationData.latitude, locationData.longitude);
      console.log('–¢–æ—á–Ω–æ—Å—Ç—å:', locationData.horizontalAccuracy);
    });
  }
});
```

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–ö–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π API:
1. –ü—Ä–æ–±—É–µ—Ç LocationManager API (Bot API 8.0+)
2. Fallback –Ω–∞ —Å—Ç–∞—Ä—ã–π `requestLocation` API (Bot API 6.0+)
3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `null` –µ—Å–ª–∏ –æ–±–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã

### –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### `checkLocationPermission()`
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –Ω–∞ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é:
```typescript
const status = await checkLocationPermission();
// status.isLocationAvailable
// status.isPermissionRequested
// status.isPermissionGranted
```

#### `openLocationSettings()`
–û—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –≤ –æ—Ç–≤–µ—Ç –Ω–∞ –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è):
```typescript
await openLocationSettings();
```

## –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è

1. **LocationManager** - –Ω–æ–≤—ã–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–± (Bot API 8.0+)
2. **requestLocation** - —Å—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± (Bot API 6.0+), –≤—Å–µ –µ—â–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
3. **–†–∞–∑—Ä–µ—à–µ–Ω–∏—è** - –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç—å —á–µ—Ä–µ–∑ `openSettings()`
4. **–¢–æ—á–Ω–æ—Å—Ç—å** - –¥–æ—Å—Ç—É–ø–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ—á–Ω–æ—Å—Ç–∏ –≤ –º–µ—Ç—Ä–∞—Ö (`horizontalAccuracy`)

### –î—Ä—É–≥–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Telegram Mini Apps

1. **–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º** (Bot API 8.0+)
   - `requestFullscreen()` / `exitFullscreen()`
   - –°–æ–±—ã—Ç–∏—è: `fullscreenChanged`, `fullscreenFailed`

2. **Safe Area** (Bot API 8.0+)
   - `safeAreaInset` - –æ—Ç—Å—Ç—É–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
   - `contentSafeAreaInset` - –æ—Ç—Å—Ç—É–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞

3. **DeviceStorage –∏ SecureStorage** (Bot API 9.0+)
   - DeviceStorage - –æ–±—ã—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
   - SecureStorage - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤

4. **–ì–ª–∞–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –∏ Back Button**
   - `WebApp.MainButton` - –≥–ª–∞–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞
   - `WebApp.BackButton` - –∫–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥"

5. **Haptic Feedback**
   - `WebApp.HapticFeedback` - —Ç–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

1. ‚úÖ **–í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤–µ—Ä—Å–∏—é API** –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
2. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ LocationManager** –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ä–æ–≥–æ `requestLocation` (Bot API 8.0+)
3. ‚úÖ **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è** –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è
4. ‚úÖ **–í—ã–∑—ã–≤–∞–π—Ç–µ `openSettings()` —Ç–æ–ª—å–∫–æ –≤ –æ—Ç–≤–µ—Ç –Ω–∞ –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**
5. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `horizontalAccuracy`** –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ—Ç–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
6. ‚úÖ **–ö—ç—à–∏—Ä—É–π—Ç–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ** –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
7. ‚úÖ **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏** –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ fallback –ª–æ–≥–∏–∫—É

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- ‚úÖ **Bot API 8.0+** - –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ LocationManager –∏ –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ **Bot API 6.0-7.9** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –Ω–∞ —Å—Ç–∞—Ä—ã–π API
- ‚úÖ **–°—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `null` —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ö–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
2. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
3. üîÑ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö —Å —Ä–∞–∑–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ Telegram
4. üîÑ –î–æ–±–∞–≤–∏—Ç—å UI –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π (–∫–Ω–æ–ø–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `openLocationSettings()`)
5. üîÑ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `horizontalAccuracy` –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ—Ç–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Telegram Mini Apps](https://core.telegram.org/bots/webapps)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è LocationManager](https://core.telegram.org/bots/webapps#locationmanager)
- [–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞](./TELEGRAM_MINI_APPS_DOCUMENTATION.md)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏](./TELEGRAM_LOCATION_MIGRATION_GUIDE.md)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏](./LOCATION_FEATURE.md)

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ö–æ–¥ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ LocationManager API —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏. –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ Telegram Mini Apps –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–µ–π.
